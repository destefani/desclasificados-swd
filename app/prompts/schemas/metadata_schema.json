{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "required": ["metadata", "original_text", "reviewed_text", "confidence"],
  "additionalProperties": false,
  "properties": {
    "metadata": {
      "type": "object",
      "required": [
        "document_id",
        "case_number",
        "document_date",
        "classification_level",
        "declassification_date",
        "document_type",
        "author",
        "recipients",
        "people_mentioned",
        "country",
        "city",
        "other_place",
        "document_title",
        "document_description",
        "archive_location",
        "observations",
        "language",
        "keywords",
        "page_count",
        "document_summary",
        "financial_references",
        "violence_references",
        "torture_references"
      ],
      "additionalProperties": false,
      "properties": {
        "document_id": {
          "type": "string",
          "description": "Unique document identifier from headers, footers, stamps, or control numbers"
        },
        "case_number": {
          "type": "string",
          "description": "Case or project number (e.g., C5199900030 for Chile Project)",
          "pattern": "^[A-Z0-9]*$"
        },
        "document_date": {
          "type": "string",
          "description": "ISO 8601 date (YYYY-MM-DD, use 00 for unknown day/month)",
          "pattern": "^\\d{4}-(0[0-9]|1[0-2])-(0[0-9]|[12][0-9]|3[01])$"
        },
        "classification_level": {
          "type": "string",
          "enum": ["TOP SECRET", "SECRET", "CONFIDENTIAL", "UNCLASSIFIED", ""],
          "description": "Original classification marking on the document"
        },
        "declassification_date": {
          "type": "string",
          "description": "Date document was declassified (YYYY-MM-DD), empty if not visible",
          "pattern": "^(\\d{4}-(0[0-9]|1[0-2])-(0[0-9]|[12][0-9]|3[01]))?$"
        },
        "document_type": {
          "type": "string",
          "enum": ["MEMORANDUM", "LETTER", "TELEGRAM", "INTELLIGENCE BRIEF", "REPORT", "MEETING MINUTES", "CABLE", ""],
          "description": "Standardized document type"
        },
        "author": {
          "type": "string",
          "description": "Author name in 'LAST, FIRST' format (uppercase). Use [FIRST NAME UNKNOWN] if only last name visible."
        },
        "recipients": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "List of recipients in 'LAST, FIRST' format (uppercase)"
        },
        "people_mentioned": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "People mentioned in document body (not just author/recipients)"
        },
        "country": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[A-Z\\s]+$"
          },
          "description": "Countries mentioned in document (uppercase)"
        },
        "city": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[A-Z\\s]+$"
          },
          "description": "Cities mentioned in document (uppercase)"
        },
        "other_place": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Other locations like regions, landmarks, or geographic areas"
        },
        "document_title": {
          "type": "string",
          "description": "Document title, subject line, or heading"
        },
        "document_description": {
          "type": "string",
          "description": "Brief description of document type and main subject"
        },
        "archive_location": {
          "type": "string",
          "description": "Archive collection, repository, or file location marked on document"
        },
        "observations": {
          "type": "string",
          "description": "Notes on document condition, redactions, illegibility, stamps, annotations"
        },
        "language": {
          "type": "string",
          "enum": ["ENGLISH", "SPANISH", ""],
          "description": "Primary document language"
        },
        "keywords": {
          "type": "array",
          "items": {
            "type": "string",
            "pattern": "^[A-Z0-9\\s\\-]+$"
          },
          "minItems": 1,
          "maxItems": 15,
          "description": "Thematic keywords (uppercase, 1-15 items)"
        },
        "page_count": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of pages visible in this image"
        },
        "document_summary": {
          "type": "string",
          "minLength": 50,
          "maxLength": 1500,
          "description": "Concise historical summary (1-3 sentences, 50-1500 characters)"
        },
        "financial_references": {
          "type": "object",
          "required": ["amounts", "financial_actors", "purposes"],
          "additionalProperties": false,
          "description": "Financial information mentioned in the document (funding, bribes, economic operations)",
          "properties": {
            "amounts": {
              "type": "array",
              "items": {
                "type": "object",
                "required": ["value", "currency", "context"],
                "additionalProperties": false,
                "properties": {
                  "value": {
                    "type": "string",
                    "description": "Numeric amount as string (e.g., '250000', '1000000')"
                  },
                  "currency": {
                    "type": "string",
                    "enum": ["USD", "CLP", "OTHER", "UNKNOWN"],
                    "description": "Currency code"
                  },
                  "context": {
                    "type": "string",
                    "description": "Brief context for the amount (e.g., 'PDC campaign funding', 'bribe to military officer')"
                  }
                }
              },
              "description": "Monetary amounts mentioned in the document"
            },
            "financial_actors": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^[A-Z0-9\\s\\-]+$"
              },
              "description": "Organizations or individuals involved in financial transactions (uppercase)"
            },
            "purposes": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["CAMPAIGN FUNDING", "COVERT OPERATION", "BRIBERY", "ECONOMIC AID", "MILITARY AID", "PROPAGANDA", "MEDIA FUNDING", "LABOR UNION FUNDING", "OTHER"]
              },
              "description": "Purpose categories for financial activities"
            }
          }
        },
        "violence_references": {
          "type": "object",
          "required": ["incident_types", "victims", "perpetrators", "has_violence_content"],
          "additionalProperties": false,
          "description": "References to violent incidents in the document",
          "properties": {
            "incident_types": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["ASSASSINATION", "ATTEMPTED ASSASSINATION", "BOMBING", "KIDNAPPING", "EXECUTION", "SHOOTING", "ARMED CONFLICT", "RAID", "OTHER"]
              },
              "description": "Types of violent incidents mentioned"
            },
            "victims": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Names of victims in 'LAST, FIRST' format (uppercase)"
            },
            "perpetrators": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Individuals or organizations responsible (e.g., 'DINA', 'MILITARY', 'CNI')"
            },
            "has_violence_content": {
              "type": "boolean",
              "description": "True if document contains references to violent acts"
            }
          }
        },
        "torture_references": {
          "type": "object",
          "required": ["detention_centers", "victims", "perpetrators", "methods_mentioned", "has_torture_content"],
          "additionalProperties": false,
          "description": "References to torture and human rights abuses in the document",
          "properties": {
            "detention_centers": {
              "type": "array",
              "items": {
                "type": "string",
                "pattern": "^[A-Z0-9\\s\\-]+$"
              },
              "description": "Known detention/torture centers mentioned (e.g., 'VILLA GRIMALDI', 'LONDRES 38', 'ESTADIO NACIONAL')"
            },
            "victims": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Names of torture victims in 'LAST, FIRST' format (uppercase)"
            },
            "perpetrators": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Individuals or organizations responsible (e.g., 'DINA', 'CNI', 'MILITARY')"
            },
            "methods_mentioned": {
              "type": "boolean",
              "description": "True if specific torture methods are described in the document"
            },
            "has_torture_content": {
              "type": "boolean",
              "description": "True if document contains references to torture or severe human rights abuses"
            }
          }
        }
      }
    },
    "original_text": {
      "type": "string",
      "description": "Faithful transcription preserving original artifacts, OCR errors, and formatting"
    },
    "reviewed_text": {
      "type": "string",
      "description": "Corrected transcription with OCR errors fixed and improved readability"
    },
    "confidence": {
      "type": "object",
      "required": ["overall", "concerns"],
      "additionalProperties": false,
      "properties": {
        "overall": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Overall confidence in transcription quality (0.0-1.0)"
        },
        "concerns": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Specific concerns or uncertainties for human review"
        }
      }
    }
  }
}
